I"l<h2 id="ä¸€context-ç”±æ¥">ä¸€ã€Context ç”±æ¥</h2>
<p>åœ¨ä¸€ä¸ªå…¸å‹çš„ React åº”ç”¨ä¸­ï¼Œæ•°æ®æ˜¯é€šè¿‡ props å±æ€§è‡ªä¸Šè€Œä¸‹è¿›è¡Œä¼ é€’çš„ï¼Œä½†æ˜¯å½“ç»„ä»¶æ ‘æ¯”è¾ƒåºå¤§çš„æ—¶å€™ï¼Œè¿™æ ·æ˜¾ç¤ºåœ°é€šè¿‡ç»„ä»¶æ ‘çš„é€å±‚ä¼ é€’å°±æ¯”è¾ƒéº»çƒ¦äº†ã€‚</p>

<h2 id="äºŒæ—§ç‰ˆ-api">äºŒã€æ—§ç‰ˆ API</h2>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PropTypes</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">prop-types</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Header</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                 <span class="nx">header</span>
                <span class="o">&lt;</span><span class="nx">Title</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Title</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">static</span> <span class="nx">contextTypes</span><span class="o">=</span><span class="p">{</span>
        <span class="na">color</span><span class="p">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">title</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Main</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">main</span>
                <span class="o">&lt;</span><span class="nx">Content</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Content</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">static</span> <span class="nx">contextTypes</span><span class="o">=</span><span class="p">{</span>
        <span class="na">color</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span>
        <span class="na">changeColor</span><span class="p">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">Content</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span><span class="o">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">ç»¿è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span><span class="o">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">orange</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">æ©™è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="na">color</span><span class="p">:</span><span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="kd">static</span> <span class="nx">childContextTypes</span><span class="o">=</span><span class="p">{</span>
        <span class="na">color</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">,</span>
        <span class="na">changeColor</span><span class="p">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">func</span>
    <span class="p">}</span>
    <span class="nx">getChildContext</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">color</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span>
            <span class="na">changeColor</span><span class="p">:(</span><span class="nx">color</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">color</span><span class="p">})</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
               <span class="nx">page</span>
                <span class="o">&lt;</span><span class="nx">Header</span><span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="nx">Main</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h2 id="ä¸‰æ–°ç‰ˆ-api">ä¸‰ã€æ–°ç‰ˆ API</h2>
<h3 id="1ç±»ç»„ä»¶">1ã€ç±»ç»„ä»¶</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">theme</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nx">Header</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">header</span>
                <span class="o">&lt;</span><span class="nx">Title</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Title</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="nx">contextType</span> <span class="o">=</span> <span class="nx">ThemeContext</span><span class="p">;</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">title</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Main</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">main</span>
                <span class="o">&lt;</span><span class="nx">Content</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Content</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="nx">contextType</span> <span class="o">=</span> <span class="nx">ThemeContext</span><span class="p">;</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">Content</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">ç»¿è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">orange</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">æ©™è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">changeColor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">color</span> <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">contextVal</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span> <span class="na">changeColor</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span> <span class="p">};</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="p">.</span><span class="nx">Provider</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">contextVal</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                    <span class="nx">page</span>
                    <span class="o">&lt;</span><span class="nx">Header</span> <span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="nx">Main</span> <span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/ThemeContext.Provider</span><span class="err">&gt;
</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="2ç±»ç»„ä»¶åŸç†å®ç°">2ã€ç±»ç»„ä»¶åŸç†å®ç°</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">createContext</span><span class="p">(){</span>
    <span class="kd">class</span> <span class="nx">Provider</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
        <span class="kd">static</span> <span class="nx">value</span><span class="p">;</span>
        <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
            <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
            <span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">value</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span><span class="nx">props</span><span class="p">.</span><span class="nx">value</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kd">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span> <span class="nx">prevState</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">nextProps</span><span class="p">.</span><span class="nx">value</span>
            <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span><span class="nx">nextProps</span><span class="p">.</span><span class="nx">value</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">class</span> <span class="nx">Consumer</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">(</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">Provider</span><span class="p">,</span>
        <span class="nx">Consumer</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">createContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">theme</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nx">Header</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">header</span>
                <span class="o">&lt;</span><span class="nx">Title</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Title</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(){</span>
        <span class="k">super</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context2</span> <span class="o">=</span> <span class="nx">Title</span><span class="p">.</span><span class="nx">contextType</span><span class="p">.</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">}</span>
    <span class="kd">static</span> <span class="nx">contextType</span> <span class="o">=</span> <span class="nx">ThemeContext</span><span class="p">;</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context2</span> <span class="o">=</span> <span class="nx">Title</span><span class="p">.</span><span class="nx">contextType</span><span class="p">.</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">title</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Main</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">main</span>
                <span class="o">&lt;</span><span class="nx">Content</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Content</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(){</span>
        <span class="k">super</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context2</span> <span class="o">=</span> <span class="nx">Title</span><span class="p">.</span><span class="nx">contextType</span><span class="p">.</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">}</span>
    <span class="kd">static</span> <span class="nx">contextType</span> <span class="o">=</span> <span class="nx">ThemeContext</span><span class="p">;</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">context2</span> <span class="o">=</span> <span class="nx">Title</span><span class="p">.</span><span class="nx">contextType</span><span class="p">.</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">Content</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">context2</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">ç»¿è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">context2</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">orange</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">æ©™è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">changeColor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">color</span> <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">contextVal</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span> <span class="na">changeColor</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span> <span class="p">};</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="p">.</span><span class="nx">Provider</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">contextVal</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                    <span class="nx">page</span>
                    <span class="o">&lt;</span><span class="nx">Header</span> <span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="nx">Main</span> <span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/ThemeContext.Provider</span><span class="err">&gt;
</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="3å‡½æ•°ç»„ä»¶">3ã€å‡½æ•°ç»„ä»¶</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">theme</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">class</span> <span class="nx">Header</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">header</span>
                <span class="o">&lt;</span><span class="nx">Title</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Title</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="p">.</span><span class="nx">Consumer</span><span class="o">&gt;</span>
            <span class="p">{</span>
                <span class="nx">value</span> <span class="o">=&gt;</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                        <span class="nx">title</span>
                    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                <span class="p">)</span>
            <span class="p">}</span>
        <span class="o">&lt;</span><span class="sr">/ThemeContext.Consumer</span><span class="err">&gt;
</span>    <span class="p">)</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Main</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="nx">main</span>
                <span class="o">&lt;</span><span class="nx">Content</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Content</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="nx">contextType</span> <span class="o">=</span> <span class="nx">ThemeContext</span><span class="p">;</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="p">.</span><span class="nx">Consumer</span><span class="o">&gt;</span>
                <span class="p">{</span>
                    <span class="nx">value</span> <span class="o">=&gt;</span> <span class="p">(</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                            <span class="nx">Content</span>
                            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">ç»¿è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">changeColor</span><span class="p">(</span><span class="dl">'</span><span class="s1">orange</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">æ©™è‰²</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="o">&lt;</span><span class="sr">/ThemeContext.Consumer</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">changeColor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">color</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">color</span> <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">contextVal</span> <span class="o">=</span> <span class="p">{</span> <span class="na">color</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">color</span><span class="p">,</span> <span class="na">changeColor</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeColor</span> <span class="p">};</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ThemeContext</span><span class="p">.</span><span class="nx">Provider</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="nx">contextVal</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                    <span class="nx">page</span>
                    <span class="o">&lt;</span><span class="nx">Header</span> <span class="o">/&gt;</span>
                    <span class="o">&lt;</span><span class="nx">Main</span> <span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/ThemeContext.Provider</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="4å‡½æ•°ç»„ä»¶å®ç°åŸç†">4ã€å‡½æ•°ç»„ä»¶å®ç°åŸç†</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">createContext</span><span class="p">(){</span>
    <span class="kd">class</span> <span class="nx">Provider</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
        <span class="kd">static</span> <span class="nx">value</span><span class="p">;</span>
        <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
            <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
            <span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">value</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span><span class="nx">props</span><span class="p">.</span><span class="nx">value</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="kd">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span> <span class="nx">prevState</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">nextProps</span><span class="p">.</span><span class="nx">value</span>
            <span class="k">return</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span><span class="nx">nextProps</span><span class="p">.</span><span class="nx">value</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kd">class</span> <span class="nx">Consumer</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
        <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
            <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">(</span><span class="nx">Provider</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="nx">Provider</span><span class="p">,</span>
        <span class="nx">Consumer</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">createContext</span><span class="p">(</span><span class="dl">'</span><span class="s1">theme</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="å››-purecomponent">å››ã€ PureComponent</h2>
<h3 id="1çº¯ç»„ä»¶ç”±æ¥">ï¼ˆ1ï¼‰çº¯ç»„ä»¶ç”±æ¥</h3>
<p>å–ä»£å…¶å‰èº« PureRenderMixinï¼ŒPureComponent æ˜¯ä¼˜åŒ– React åº”ç”¨ç¨‹åºæœ€é‡è¦çš„æ–¹æ³•ä¹‹ä¸€ï¼Œæ˜“äºå®æ–½ï¼Œåªè¦æŠŠç»§æ‰¿ç±»ä» Component æ¢æˆ PureComponent å³å¯ï¼Œå¯ä»¥å‡å°‘ä¸å¿…è¦çš„ render æ“ä½œçš„æ¬¡æ•°ï¼Œä»è€Œæé«˜æ€§èƒ½ï¼Œè€Œä¸”å¯ä»¥å°‘å†™ shouldComponentUpdate å‡½æ•°</p>
<h3 id="2çº¯ç»„ä»¶åŸç†">ï¼ˆ2ï¼‰çº¯ç»„ä»¶åŸç†</h3>
<p>PureComponent é€šè¿‡ prop å’Œ state çš„æµ…æ¯”è¾ƒæ¥å®ç° shouldComponentUpdateï¼Œå½“ç»„ä»¶æ›´æ–°æ—¶ï¼Œå¦‚æœç»„ä»¶çš„ props å’Œ state éƒ½æ²¡å‘ç”Ÿæ”¹å˜ï¼Œrender æ–¹æ³•å°±ä¸ä¼šè§¦å‘ï¼Œçœå» Virtual DOM çš„ç”Ÿæˆå’Œæ¯”å¯¹è¿‡ç¨‹ï¼Œè¾¾åˆ°æå‡æ€§èƒ½çš„ç›®çš„ã€‚</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">shallowEqual</span><span class="p">(</span><span class="nx">obj1</span><span class="p">,</span><span class="nx">obj2</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">obj1</span> <span class="o">===</span> <span class="nx">obj2</span><span class="p">){</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">obj1</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">obj1</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span><span class="k">typeof</span> <span class="nx">obj2</span> <span class="o">!=</span> <span class="dl">'</span><span class="s1">object</span><span class="dl">'</span> <span class="o">||</span> <span class="nx">obj2</span> <span class="o">===</span> <span class="kc">null</span> <span class="p">){</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kd">let</span> <span class="nx">keys1</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj1</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">keys2</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj2</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">keys1</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="nx">keys2</span><span class="p">.</span><span class="nx">length</span><span class="p">){</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">key</span> <span class="k">of</span> <span class="nx">keys1</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">obj2</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="o">||</span> <span class="nx">obj1</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">obj2</span><span class="p">[</span><span class="nx">key</span><span class="p">]){</span>
            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">PureComponent</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">isPureReactComponent</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="nx">shouldComponentUpdate</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span><span class="nx">nextState</span><span class="p">){</span>
        <span class="k">return</span> <span class="o">!</span><span class="nx">shallowEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">,</span><span class="nx">nextProps</span><span class="p">)</span><span class="o">||!</span><span class="nx">shallowEqual</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">,</span><span class="nx">nextState</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="äº”é«˜é˜¶ç»„ä»¶">äº”ã€é«˜é˜¶ç»„ä»¶</h2>
<ul>
  <li>é«˜é˜¶ç»„ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ ç»™å®ƒä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶</li>
  <li>é«˜é˜¶ç»„ä»¶çš„ä½œç”¨æ˜¯ä¸ºäº†ç»„ä»¶ä¹‹é—´ä»£ç çš„å¤ç”¨
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">NewComponent</span> <span class="o">=</span> <span class="nx">higherOrderComponent</span><span class="p">(</span><span class="nx">OldComponent</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="1æ—¥å¿—ç»„ä»¶">1ã€æ—¥å¿—ç»„ä»¶</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">logger</span> <span class="o">=</span> <span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">class</span> <span class="nx">LoggerComponent</span> <span class="kd">extends</span> <span class="nx">Component</span> <span class="p">{</span>
      <span class="nx">componentWillMount</span><span class="p">(){</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
      <span class="p">}</span>  
      <span class="nx">componentDidMount</span><span class="p">(){</span>
          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">((</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">start</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">ms</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">}</span>
      <span class="nx">render</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="o">/&gt;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">LoggerComponent</span><span class="p">;</span>
  <span class="p">}</span>
<span class="kd">let</span> <span class="nx">Hello</span> <span class="o">=</span> <span class="nx">logger</span><span class="p">(</span><span class="nx">props</span><span class="o">=&gt;&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">hello</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span><span class="se">)</span><span class="err">;
</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Hello</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="2å¤šå±‚é«˜é˜¶ç»„ä»¶">2ã€å¤šå±‚é«˜é˜¶ç»„ä»¶</h3>
<h4 id="1ä»-localstorage-ä¸­åŠ è½½">ï¼ˆ1ï¼‰ä» localStorage ä¸­åŠ è½½</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">fromLocal</span> <span class="o">=</span> <span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">,</span><span class="nx">name</span><span class="p">)</span> <span class="o">=&gt;</span><span class="p">{</span>
    <span class="kd">class</span> <span class="nx">NewComponent</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
        <span class="kd">constructor</span><span class="p">(){</span>
            <span class="k">super</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">value</span><span class="p">:</span><span class="kc">null</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="nx">componentWillMount</span><span class="p">(){</span>
            <span class="kd">let</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
             <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">value</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">NewComponent</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">UserName</span> <span class="o">=</span> <span class="p">({</span><span class="nx">value</span><span class="p">})</span><span class="o">=&gt;</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">defaultValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">value</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">UserNameFromLocal</span> <span class="o">=</span> <span class="nx">fromLocal</span><span class="p">(</span><span class="nx">UserName</span><span class="p">,</span><span class="dl">'</span><span class="s1">username</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">UserNameFromLocal</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h4 id="2ä»-ajax-ä¸­åŠ è½½">ï¼ˆ2ï¼‰ä» ajax ä¸­åŠ è½½</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">fromLocal</span> <span class="o">=</span> <span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">,</span><span class="nx">name</span><span class="p">)</span> <span class="o">=&gt;</span><span class="p">{</span>
    <span class="kd">class</span> <span class="nx">NewComponent</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
        <span class="kd">constructor</span><span class="p">(){</span>
            <span class="k">super</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span><span class="kc">null</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="nx">componentWillMount</span><span class="p">(){</span>
            <span class="kd">let</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">id</span><span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="nx">id</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">NewComponent</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">fromAjax</span> <span class="o">=</span> <span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">)</span> <span class="o">=&gt;</span><span class="p">{</span>
    <span class="kd">class</span> <span class="nx">NewComponent</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
        <span class="kd">constructor</span><span class="p">(){</span>
            <span class="k">super</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">value</span><span class="p">:{}};</span>
        <span class="p">}</span>
        <span class="nx">componentDidMount</span><span class="p">(){</span>
            <span class="nx">fetch</span><span class="p">(</span><span class="s2">`/</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">.json`</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="o">=&gt;</span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()).</span><span class="nx">then</span><span class="p">(</span><span class="nx">value</span><span class="o">=&gt;</span><span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">value</span><span class="p">});</span>
            <span class="p">});</span>
        <span class="p">}</span>
        <span class="nx">render</span><span class="p">(){</span>
            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">value</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">NewComponent</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">UserName</span> <span class="o">=</span> <span class="p">({</span><span class="nx">value</span><span class="p">})</span><span class="o">=&gt;</span><span class="p">{</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">defaultValue</span> <span class="o">=</span> <span class="p">{</span><span class="nx">value</span><span class="p">.</span><span class="nx">username</span><span class="p">}</span><span class="sr">/&gt;</span><span class="err">;
</span><span class="p">}</span>

<span class="kd">const</span> <span class="nx">UserNameFromAjax</span> <span class="o">=</span> <span class="nx">fromAjax</span><span class="p">(</span><span class="nx">UserName</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">UserNameFromLocal</span> <span class="o">=</span> <span class="nx">fromLocal</span><span class="p">(</span><span class="nx">UserNameFromAjax</span><span class="p">,</span><span class="dl">'</span><span class="s1">username</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">UserNameFromLocal</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h2 id="å…­render-props">å…­ã€render props</h2>
<ul>
  <li>render props æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„aä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯</li>
  <li>å…·æœ‰ render prop çš„ç»„ä»¶æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ª React å…ƒç´ å¹¶è°ƒç”¨å®ƒè€Œä¸æ˜¯å®ç°è‡ªå·±çš„æ¸²æŸ“é€»è¾‘</li>
  <li>render prop æ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° prop</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">DataProvider</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">target</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span><span class="p">)}</span><span class="sr">/</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="1åŸç”Ÿå®ç°">1ã€åŸç”Ÿå®ç°</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MouseTracker</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">handleMouseMove</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="na">x</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span>
            <span class="na">y</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onMouseMove</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleMouseMove</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="err">ç§»åŠ¨é¼ æ ‡</span><span class="o">!&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="err">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯</span> <span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">x</span><span class="p">},</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">y</span><span class="p">})</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="2-children">2ã€ children</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MouseTracker</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">handleMouseMove</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="na">x</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span>
            <span class="na">y</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onMouseMove</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleMouseMove</span><span class="p">}</span><span class="o">&gt;</span>
               <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">)}</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">Cat</span><span class="p">({}){</span>

<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span> <span class="nx">MouseTracker</span> <span class="o">&gt;</span>
<span class="p">{</span>
    <span class="nx">props</span><span class="o">=&gt;</span><span class="p">(</span>
        <span class="o">&lt;&gt;</span>
          <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="err">ç§»åŠ¨é¼ æ ‡</span><span class="o">!&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="err">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯</span> <span class="p">({</span><span class="nx">props</span><span class="p">.</span><span class="nx">x</span><span class="p">},</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">y</span><span class="p">})</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>    <span class="p">)</span>
<span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/ MouseTracker&gt;, document.getElementById</span><span class="se">(</span><span class="sr">'root'</span><span class="se">))</span><span class="err">;
</span></code></pre></div></div>

<h3 id="3render-å±æ€§">3ã€render å±æ€§</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MouseTracker</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">handleMouseMove</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="na">x</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span>
            <span class="na">y</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onMouseMove</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleMouseMove</span><span class="p">}</span><span class="o">&gt;</span>
               <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">)}</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span> <span class="nx">MouseTracker</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">props</span><span class="o">=&gt;</span><span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="err">ç§»åŠ¨é¼ æ ‡</span><span class="o">!&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="err">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯</span> <span class="p">({</span><span class="nx">props</span><span class="p">.</span><span class="nx">x</span><span class="p">},</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">y</span><span class="p">})</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span><span class="p">)}</span> <span class="sr">/&gt;, document.getElementById</span><span class="se">(</span><span class="sr">'root'</span><span class="se">))</span><span class="err">;
</span></code></pre></div></div>

<h3 id="4hoc">4ã€HOC</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">MouseTracker</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">handleMouseMove</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="na">x</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientX</span><span class="p">,</span>
            <span class="na">y</span><span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">clientY</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">onMouseMove</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleMouseMove</span><span class="p">}</span><span class="o">&gt;</span>
               <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">)}</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">withMouse</span><span class="p">(</span><span class="nx">Component</span><span class="p">){</span>
 <span class="k">return</span> <span class="p">(</span>
     <span class="p">(</span><span class="nx">props</span><span class="p">)</span><span class="o">=&gt;&lt;</span><span class="nx">MouseTracker</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">mouse</span><span class="o">=&gt;&lt;</span><span class="nx">Component</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="p">{...</span><span class="nx">mouse</span><span class="p">}</span><span class="sr">/&gt;}/</span><span class="o">&gt;</span>
 <span class="p">)</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">App</span> <span class="o">=</span> <span class="nx">withMouse</span><span class="p">(</span><span class="nx">props</span><span class="o">=&gt;</span><span class="p">(</span>
    <span class="o">&lt;&gt;</span>
      <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="err">ç§»åŠ¨é¼ æ ‡</span><span class="o">!&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="err">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯</span> <span class="p">({</span><span class="nx">props</span><span class="p">.</span><span class="nx">x</span><span class="p">},</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">y</span><span class="p">})</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span><span class="p">));</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">App</span><span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h2 id="ä¸ƒæ’æ§½portals">ä¸ƒã€æ’æ§½ï¼ˆPortalsï¼‰</h2>
<ul>
  <li>Portals æä¾›äº†ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•ï¼Œå°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ DOM å±‚æ¬¡ç»“æ„ä¹‹å¤–çš„ DOM èŠ‚ç‚¹ã€‚</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">createPortal</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">container</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆchildï¼‰æ˜¯ä»»ä½•å¯æ¸²æŸ“çš„ React å­å…ƒç´ ï¼Œä¾‹å¦‚ä¸€ä¸ªå…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ– ç‰‡æ®µ(fragment)</li>
  <li>ç¬¬äºŒä¸ªå‚æ•°ï¼ˆcontainerï¼‰åˆ™æ˜¯ä¸€ä¸ª DOM å…ƒç´ </li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">Modal</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">modal</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">createPortal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">modal</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">constructor</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="na">show</span><span class="p">:</span><span class="kc">false</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">handleClick</span><span class="o">=</span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">show</span><span class="p">:</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">show</span><span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="err">æ˜¾ç¤ºæ¨¡æ€çª—å£</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                <span class="p">{</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">show</span><span class="o">&amp;&amp;&lt;</span><span class="nx">Modal</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">modal</span><span class="dl">"</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">modal</span><span class="dl">"</span><span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">modal-content</span><span class="dl">"</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">modal-content</span><span class="dl">"</span><span class="o">&gt;</span>
                                <span class="err">å†…å®¹</span>
                                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="err">å…³é—­</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/Modal</span><span class="err">&gt;
</span>                <span class="p">}</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h2 id="å…«é”™è¯¯è¾¹ç•Œerror-boundaries">å…«ã€é”™è¯¯è¾¹ç•Œï¼ˆError Boundariesï¼‰</h2>
<ul>
  <li>éƒ¨åˆ† UI ä¸­çš„ JavaScript é”™è¯¯ä¸åº”è¯¥ç ´åæ•´ä¸ªåº”ç”¨ç¨‹åº</li>
  <li>ä¸ºäº†è§£å†³ React ç”¨æˆ·çš„è¿™ä¸ªé—®é¢˜ï¼ŒReact 16å¼•å…¥äº†ä¸€ä¸ª é”™è¯¯è¾¹ç•Œ(Error Boundaries)çš„æ–°æ¦‚å¿µ</li>
  <li>é”™è¯¯è¾¹ç•Œæ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å¯ä»¥ç”¨æ¥æ•è·å®ƒçš„å­ç»„ä»¶ä¸­äº§ç”Ÿçš„é”™è¯¯ï¼Œè®°å½•é”™è¯¯æ—¥å¿—å¹¶åœ¨é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå±•ç¤ºä¸€ä¸ªâ€œå›é€€â€æˆ–è€…è¯´æ˜¯ä¸€ä¸ªé”™è¯¯ä¿¡æ¯é¡µé¢ï¼Œä»¥é¿å…å› ä¸ºå±€éƒ¨ç»„ä»¶é”™è¯¯è€Œå¯¼è‡´çš„æ•´ä¸ªç»„ä»¶æ ‘å´©æºƒ</li>
  <li>é”™è¯¯è¾¹ç•Œå¯ä»¥æ•è·å…¶å­ç»„ä»¶çš„æ¸²æŸ“ã€ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä»¥åŠæ„é€ å‡½æ•°å†…çš„é”™è¯¯</li>
  <li>è¿™ä¸ªç»„ä»¶æ˜¯æ‰€æœ‰å­ç»„ä»¶å‘é€é”™è¯¯çš„æ•è·è€…ï¼Œæ‰€æœ‰å­ç»„ä»¶çš„é”™è¯¯åˆ°è¾¾é”™è¯¯è¾¹ç•Œç»„ä»¶åï¼Œé”™è¯¯ä¿¡æ¯è¢«æ‹¦æˆªå¹¶ä¸å†å‘ä¸Šå†’æ³¡ï¼Œæ‰€ä»¥è¿™ä¸ªç»„ä»¶å°±æ˜¯é”™è¯¯çš„ä¸€ä¸ªè¾¹ç•Œ</li>
  <li>åŸåˆ™ä¸Šæ¥è®²ï¼Œé”™è¯¯è¾¹ç•Œæ˜¯ç”¨æ¥ä¿è¯Reactå¯ä»¥æ­£å¸¸æ¸²æŸ“UIçš„ï¼Œè€Œä¸æ˜¯çœŸçš„ç”¨æ¥æ•è·å¼‚å¸¸çš„</li>
  <li>è‡ª React 16 å¼€å§‹ï¼Œä»»ä½•æœªè¢«é”™è¯¯è¾¹ç•Œæ•è·çš„é”™è¯¯å°†ä¼šå¸è½½æ•´ä¸ª React ç»„ä»¶æ ‘</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">ErrorBoundary</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="o">=</span><span class="p">{</span><span class="na">hasError</span><span class="p">:</span><span class="kc">false</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">componentDidCatch</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">info</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">hasError</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">hasError</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Something</span> <span class="nx">Went</span> <span class="nx">Wrong</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>        <span class="p">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">Page</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ErrorBoundary</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">Clock</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/ErrorBoundary</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">Clock</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">hello</span><span class="p">{</span><span class="kc">null</span><span class="p">.</span><span class="nx">toString</span><span class="p">()}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Page</span><span class="o">/&gt;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<p><strong><em>å€Ÿé‰´çš„æ–‡æ¡£ï¼š</em></strong><br />
<a href="https://zh-hans.reactjs.org/docs/context.html">React å®˜æ–¹æ•™ç¨‹</a></p>
:ET