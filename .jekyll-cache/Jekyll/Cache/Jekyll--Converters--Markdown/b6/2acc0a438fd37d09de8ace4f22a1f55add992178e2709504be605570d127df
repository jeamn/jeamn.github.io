I"Yş<h2 id="ä¸€ä»€ä¹ˆæ˜¯-react">ä¸€ã€ä»€ä¹ˆæ˜¯ React</h2>
<ul>
  <li>React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œæ ¸å¿ƒä¸“æ³¨äºè§†å›¾å±‚ï¼Œç›®çš„å®ç°ç»„ä»¶åŒ–å¼€å‘</li>
</ul>

<h2 id="äºŒç»„ä»¶åŒ–çš„æ¦‚å¿µ">äºŒã€ç»„ä»¶åŒ–çš„æ¦‚å¿µ</h2>
<p>å°†ä¸€ä¸ªå¤æ‚çš„é¡µé¢åˆ†å‰²æˆè‹¥å¹²ä¸ªç‹¬ç«‹ç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶åŒ…å«è‡ªå·±çš„é€»è¾‘å’Œæ ·å¼ï¼Œå†å°†è¿™äº›ç‹¬ç«‹ç»„ä»¶ç»„åˆæˆä¸€ä¸ªå¤æ‚çš„é¡µé¢</p>

<ul>
  <li>å¯ç»„åˆï¼š ä¸€ä¸ªç»„ä»¶å¯ä»¥å’Œå…¶ä»–ç»„ä»¶ä¸€èµ·ä½¿ç”¨æˆ–è€…å¯ä»¥ç›´æ¥åµŒå¥—åœ¨å¦ä¸€ä¸ªç»„ä»¶å†…éƒ¨</li>
  <li>å¯é‡ç”¨ï¼š æ¯ä¸ªç»„ä»¶éƒ½æ˜¯å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„ï¼Œå®ƒå¯ä»¥è¢«ä½¿ç”¨åœ¨å¤šä¸ªåœºæ™¯ä¸­</li>
  <li>å¯ç»´æŠ¤ï¼š æ¯ä¸ªå°çš„ç»„ä»¶ä»…ä»…åŒ…å«è‡ªèº«çš„é€»è¾‘ï¼Œæ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤</li>
</ul>

<h2 id="ä¸‰æ­å»º-react-å¼€å‘ç¯å¢ƒ">ä¸‰ã€æ­å»º React å¼€å‘ç¯å¢ƒ</h2>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">create</span><span class="o">-</span><span class="nx">react</span><span class="o">-</span><span class="nx">app</span> <span class="o">-</span><span class="nx">g</span>
<span class="nx">create</span><span class="o">-</span><span class="nx">react</span><span class="o">-</span><span class="nx">app</span> <span class="nx">my</span><span class="o">-</span><span class="nx">app</span>
<span class="nx">cd</span> <span class="nx">my</span><span class="o">-</span><span class="nx">app</span>
<span class="nx">yarn</span> <span class="nx">start</span>
</code></pre></div></div>
<p>é»˜è®¤ä¼šå®‰è£… React ï¼ŒReact ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
  <li>react.js æ˜¯ React çš„æ ¸å¿ƒåº“</li>
  <li>react-dom.js æ˜¯æä¾›ä¸ DOM ç›¸å…³çš„åŠŸèƒ½ï¼Œå†…éƒ¨æ¯”è¾ƒé‡è¦çš„æ–¹æ³•æ˜¯ render ï¼Œå®ƒçš„ä½œç”¨æ˜¯å‘HTML é‡Œæ’å…¥ DOM å…ƒç´ </li>
</ul>

<h2 id="å››jsx-è¯­æ³•">å››ã€JSX è¯­æ³•</h2>
<h3 id="1ä»€ä¹ˆæ˜¯-jsx">1ã€ä»€ä¹ˆæ˜¯ JSXï¼š</h3>
<p>JSX æ˜¯ä¸€ç§ JS å’Œ HTML æ··åˆçš„è¯­æ³•ï¼Œå°†ç»„ä»¶çš„ç»“æ„ã€æ•°æ®å’Œæ ·å¼æœ‰èšåˆåœ¨ä¸€èµ·å®šä¹‰ç»„ä»¶ï¼ŒJSX è¯­æ³•ä¼šè¢« babel ç¼–è¯‘æˆ createElement è¯­æ³•ï¼Œå³ï¼š</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">className</span><span class="o">=</span><span class="dl">"</span><span class="s2">title</span><span class="dl">"</span> <span class="nx">style</span><span class="o">=&gt;</span>
    <span class="nx">Hello</span> <span class="o">&lt;</span><span class="nx">i</span> <span class="nx">id</span><span class="o">=</span><span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">Jeamn</span><span class="o">&lt;</span><span class="sr">/i</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span></code></pre></div></div>

<p>ç»è¿‡ babel è½¬è¯‘åä¼šå˜æˆ:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">h1</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">className</span><span class="p">:</span> <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">style</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">color</span><span class="p">:</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">fontSize</span><span class="p">:</span> <span class="dl">'</span><span class="s1">50rpx</span><span class="dl">'</span>
  <span class="p">}</span>
<span class="p">},</span> <span class="dl">"</span><span class="s2">Hello</span><span class="dl">"</span><span class="p">,</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">i</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span>
<span class="p">},</span> <span class="dl">"</span><span class="s2">Jeamn</span><span class="dl">"</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="2ä»€ä¹ˆæ˜¯å…ƒç´ ">2ã€ä»€ä¹ˆæ˜¯å…ƒç´ </h3>
<ul>
  <li>å…ƒç´ æ˜¯æ„æˆ React åº”ç”¨çš„æœ€å°å•ä½</li>
  <li>React å½“ä¸­çš„å…ƒç´ äº‹å®ä¸Šæ˜¯æ™®é€šçš„ JS å¯¹è±¡ï¼ŒReactDOM æ¥ç¡®ä¿æµè§ˆå™¨ä¸­çš„ DOM æ•°æ®å’Œ React å…ƒç´ ä¿æŒä¸€è‡´</li>
</ul>

<h3 id="3jsx-å±æ€§">3ã€JSX å±æ€§</h3>
<ul>
  <li>å±æ€§ä¸­ä¸èƒ½åŒ…å«å…³é”®å­—ï¼Œå¦‚ class è¦å†™æˆ classNameï¼Œfor è¦å†™æˆ htmlForï¼Œå±æ€§åè¦é‡‡ç”¨é©¼å³°å‘½åæ³•</li>
</ul>

<h3 id="4æ›´æ–°å…ƒç´ æ¸²æŸ“">4ã€æ›´æ–°å…ƒç´ æ¸²æŸ“</h3>
<ul>
  <li>React å…ƒç´ éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œå½“å…ƒç´ è¢«åˆ›å»ºä¹‹åï¼Œæ— æ³•æ”¹å˜å…¶å†…å®¹æˆ–å±æ€§</li>
  <li>æ›´æ–°ç•Œé¢çš„å”¯ä¸€åŠæ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç´ ï¼Œç„¶åå°†å®ƒä¼ å…¥ ReactDOM.render()æ–¹æ³•</li>
</ul>

<h3 id="5æ›´æ–°æœºåˆ¶">5ã€æ›´æ–°æœºåˆ¶</h3>
<ul>
  <li>React åªä¼šæ›´æ–°å¿…è¦çš„éƒ¨åˆ†</li>
  <li>ReactDOM é¦–å…ˆä¼šæ¯”è¾ƒå…ƒç´ å†…å®¹å…ˆåçš„ä¸åŒï¼Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­åªä¼šæ›´æ–°æ”¹å˜äº†çš„éƒ¨åˆ†</li>
  <li>å³ä½¿æ¯ç§’éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°å…ƒç´ ï¼ŒReactDOM ä¹Ÿåªä¼šæ›´æ–°æ¸²æŸ“æ–‡æœ¬èŠ‚ç‚¹ä¸­å‘ç”Ÿå˜åŒ–çš„å†…å®¹</li>
</ul>

<h2 id="äº”ç»„ä»¶">äº”ã€ç»„ä»¶</h2>
<h3 id="1å‡½æ•°ç»„ä»¶">1ã€å‡½æ•°ç»„ä»¶</h3>
<p>å‡½æ•°ç»„ä»¶æ¥æ”¶ä¸€ä¸ªå•ä¸€çš„ props å¯¹è±¡å¹¶è¿”å›ä¸€ä¸ª React å…ƒç´ </p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">SayHello</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="2ç±»ç»„ä»¶">2ã€ç±»ç»„ä»¶</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">SayHello</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">hello</span><span class="p">,</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="3ç»„ä»¶æ¸²æŸ“">3ã€ç»„ä»¶æ¸²æŸ“</h3>
<ul>
  <li>React å…ƒç´ ä¸ä½†å¯ä»¥æ˜¯ DOM æ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶</li>
  <li>å½“ React å…ƒç´ ä¸ºç”¨æˆ·è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œå®ƒä¼šå°† JSX æ‰€æ¥æ”¶çš„å±æ€§è½¬æ¢ä¸ºå•ä¸ªå¯¹è±¡ä¼ é€’ç»™ç»„ä»¶ï¼Œè¿™ä¸ªå¯¹è±¡è¢«ç§°ä¹‹ä¸º props</li>
  <li>ç»„ä»¶åç§°å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´</li>
  <li>ç»„ä»¶å¿…é¡»åœ¨ä½¿ç”¨çš„æ—¶å€™å®šä¹‰æˆ–å¼•ç”¨å®ƒ</li>
  <li>ç»„ä»¶çš„è¿”å›å€¼åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ </li>
</ul>

<h3 id="4props-çš„åªè¯»æ€§">4ã€props çš„åªè¯»æ€§</h3>
<ul>
  <li>æ— è®ºæ˜¯ä½¿ç”¨å‡½æ•°è¿˜æ˜¯ç±»æ¥å£°æ˜ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒç»ä¸èƒ½ä¿®æ”¹è‡ªå·±çš„ props</li>
  <li>æ‰€æœ‰çš„ React ç»„ä»¶éƒ½å¿…é¡»åƒçº¯å‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒä»¬çš„ props</li>
  <li>çº¯å‡½æ•°ç‰¹ç‚¹ï¼šä¸æ”¹å˜å…¥å‚ã€ä¸æ”¹å˜å¤–ç•Œå˜é‡å€¼</li>
</ul>

<h3 id="5ä½¿ç”¨-proptypes-è¿›è¡Œç±»å‹æ£€æŸ¥">5ã€ä½¿ç”¨ PropTypes è¿›è¡Œç±»å‹æ£€æŸ¥</h3>
<ul>
  <li>PropTypes æ˜¯ React æä¾›çš„ä¸€ä¸ªç±»å‹æ£€æŸ¥çš„åŠŸèƒ½</li>
  <li>è¦åœ¨ç»„ä»¶çš„ props ä¸Šè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œåªéœ€é…ç½®ç‰¹å®šçš„ propTypes å±æ€§</li>
  <li>å¯ä»¥é€šè¿‡é…ç½®ç‰¹å®šçš„ defaultProps å±æ€§æ¥å®šä¹‰ props çš„é»˜è®¤å€¼</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PropTypes</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">prop-types</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Person</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="kd">static</span> <span class="nx">defaultProps</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span><span class="dl">'</span><span class="s1">Stranger</span><span class="dl">'</span>
    <span class="p">}</span>
    <span class="kd">static</span> <span class="nx">propTypes</span><span class="o">=</span><span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
        <span class="na">age</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
        <span class="na">gender</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">oneOf</span><span class="p">([</span><span class="dl">'</span><span class="s1">male</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">female</span><span class="dl">'</span><span class="p">]),</span>
        <span class="na">hobby</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">array</span><span class="p">,</span>
        <span class="na">postion</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">shape</span><span class="p">({</span>
            <span class="na">x</span><span class="p">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span><span class="p">,</span>
            <span class="na">y</span><span class="p">:</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">number</span>
        <span class="p">}),</span>
        <span class="nx">age</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span><span class="nx">propName</span><span class="p">,</span><span class="nx">componentName</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">age</span><span class="o">=</span><span class="nx">props</span><span class="p">[</span><span class="nx">propName</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">age</span> <span class="o">&lt;</span><span class="mi">0</span> <span class="o">||</span> <span class="nx">age</span><span class="o">&gt;</span><span class="mi">120</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">`Invalid Prop </span><span class="p">${</span><span class="nx">propName</span><span class="p">}</span><span class="s2"> supplied to </span><span class="p">${</span><span class="nx">componentName</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="p">{</span><span class="nx">name</span><span class="p">,</span><span class="nx">age</span><span class="p">,</span><span class="nx">gender</span><span class="p">,</span><span class="nx">hobby</span><span class="p">,</span><span class="nx">position</span><span class="p">}</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">table</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">thead</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="err">å§“å</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="err">å¹´é¾„</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="err">æ€§åˆ«</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="err">çˆ±å¥½</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="err">ä½ç½®</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/tr</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/thead</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">tbody</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">tr</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">age</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">gender</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">hobby</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">,</span><span class="dl">'</span><span class="p">)}</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                    <span class="o">&lt;</span><span class="nx">td</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span><span class="o">+</span><span class="dl">'</span><span class="s1"> </span><span class="dl">'</span><span class="o">+</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/td</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/tr</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="sr">/tbody</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/table</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">person</span><span class="o">=</span><span class="p">{</span>
    <span class="na">age</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="na">gender</span><span class="p">:</span><span class="dl">'</span><span class="s1">male</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">hobby</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">basketball</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">football</span><span class="dl">'</span><span class="p">],</span>
    <span class="na">position</span><span class="p">:</span> <span class="p">{</span><span class="na">x</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span><span class="na">y</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Person</span> <span class="p">{...</span><span class="nx">person</span><span class="p">}</span><span class="sr">/&gt;, document.getElementById</span><span class="se">(</span><span class="sr">'root'</span><span class="se">))</span><span class="err">;
</span></code></pre></div></div>

<h2 id="å…­è™šæ‹Ÿ-dom">å…­ã€è™šæ‹Ÿ DOM</h2>
<h3 id="1indexjså‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶">1ã€index.jsï¼ˆå‡½æ•°å¼ç»„ä»¶å’Œç±»ç»„ä»¶ï¼‰</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// å‡½æ•°å¼ç»„ä»¶</span>
<span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">h1</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">welcome</span><span class="dl">'</span><span class="p">},</span> <span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">props</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">// ç±»ç»„ä»¶</span>
<span class="kd">class</span> <span class="nx">Welcome1</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">h1</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">welcome</span><span class="dl">'</span><span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> 
<span class="kd">let</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">Welcome1</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">jeamn</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">age</span><span class="p">:</span> <span class="mi">30</span>
<span class="p">})</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="2reactjså®ç°-react-æä¾›çš„-createelement-æ–¹æ³•åˆ›å»ºå…ƒç´ ">2ã€react.jsï¼ˆå®ç° React æä¾›çš„ createElement æ–¹æ³•åˆ›å»ºå…ƒç´ ï¼‰</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">static</span> <span class="nx">isReactComponent</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">props</span> <span class="o">=</span> <span class="nx">props</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">ReactElement</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">props</span><span class="p">){</span>
    <span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="p">{</span><span class="nx">type</span><span class="p">,</span> <span class="nx">props</span><span class="p">}</span>
    <span class="k">return</span> <span class="nx">element</span>
<span class="p">}</span>

<span class="c1">// å®ç° React æä¾›çš„ createElement æ–¹æ³•åˆ›å»ºå…ƒç´ </span>
<span class="kd">function</span> <span class="nx">createElement</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">config</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">children</span><span class="p">){</span>
    <span class="kd">let</span> <span class="nx">propName</span>
    <span class="kd">const</span> <span class="nx">props</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">propName</span> <span class="k">in</span> <span class="nx">config</span><span class="p">){</span>
        <span class="nx">props</span><span class="p">[</span><span class="nx">propName</span><span class="p">]</span> <span class="o">=</span> <span class="nx">config</span><span class="p">[</span><span class="nx">propName</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">childrenLength</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">childrenLength</span> <span class="o">===</span> <span class="mi">1</span><span class="p">){</span>
        <span class="nx">props</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="nx">children</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">childrenLength</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">){</span>
        <span class="nx">props</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ReactElement</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">props</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span><span class="nx">createElement</span><span class="p">,</span> <span class="nx">Component</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="3react-domå®ç°-reactdom-çš„-render-æ–¹æ³•è¿›è¡ŒèŠ‚ç‚¹æ¸²æŸ“">3ã€react-domï¼ˆå®ç° ReactDOM çš„ render æ–¹æ³•è¿›è¡ŒèŠ‚ç‚¹æ¸²æŸ“ï¼‰</h3>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">render</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">parentNode</span><span class="p">){</span>
    <span class="c1">// æ™®é€šå­—ç¬¦ä¸²å¤„ç†</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">element</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">element</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">){</span>
        <span class="k">return</span> <span class="nx">parentNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="c1">// å…ƒç´ å¤„ç†</span>
    <span class="kd">let</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">props</span>
    <span class="nx">type</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">type</span>
    <span class="nx">props</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">props</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">type</span><span class="p">.</span><span class="nx">isReactComponent</span><span class="p">){</span>
        <span class="kd">let</span> <span class="nx">returnedElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">type</span><span class="p">(</span><span class="nx">props</span><span class="p">).</span><span class="nx">render</span><span class="p">()</span>
        <span class="nx">type</span> <span class="o">=</span> <span class="nx">returnedElement</span><span class="p">.</span><span class="nx">type</span>
        <span class="nx">props</span> <span class="o">=</span> <span class="nx">returnedElement</span><span class="p">.</span><span class="nx">props</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">type</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">function</span><span class="dl">'</span><span class="p">){</span>
        <span class="kd">let</span> <span class="nx">returnedElement</span> <span class="o">=</span> <span class="nx">type</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
        <span class="nx">type</span> <span class="o">=</span> <span class="nx">returnedElement</span><span class="p">.</span><span class="nx">type</span>
        <span class="nx">props</span> <span class="o">=</span> <span class="nx">returnedElement</span><span class="p">.</span><span class="nx">props</span>
    <span class="p">}</span>

    <span class="kd">let</span> <span class="nx">domElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span>  <span class="c1">// span</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">propName</span> <span class="k">in</span> <span class="nx">props</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">propName</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">className</span><span class="dl">'</span><span class="p">){</span>
            <span class="nx">domElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">propName</span><span class="p">]</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">propName</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">style</span><span class="dl">'</span><span class="p">){</span>
            <span class="kd">let</span> <span class="nx">styleObj</span> <span class="o">=</span> <span class="nx">props</span><span class="p">[</span><span class="nx">propName</span><span class="p">]</span>
            <span class="c1">// for(let attr in styleObj){</span>
            <span class="c1">//     domElement.style[attr] = styleObj[attr]</span>
            <span class="c1">// }</span>
            <span class="kd">let</span> <span class="nx">cssText</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">styleObj</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">attr</span> <span class="o">=&gt;</span> 
                <span class="s2">`</span><span class="p">${</span><span class="nx">attr</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">([</span><span class="sr">A-Z</span><span class="se">])</span><span class="sr">/g</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
                    <span class="k">return</span> <span class="dl">"</span><span class="s2">-</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">()}</span><span class="s2">)}:</span><span class="p">${</span><span class="nx">styleObj</span><span class="p">[</span><span class="nx">attr</span><span class="p">]}</span><span class="s2">`</span>
            <span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">'</span><span class="s1">;</span><span class="dl">'</span><span class="p">)</span>
            <span class="nx">domElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="nx">cssText</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">propName</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">children</span><span class="dl">'</span><span class="p">){</span>
            <span class="kd">let</span> <span class="nx">children</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">)</span> <span class="p">?</span> <span class="nx">props</span><span class="p">.</span><span class="nx">children</span> <span class="p">:</span> <span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">]</span>
            <span class="nx">children</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">child</span> <span class="o">=&gt;</span> <span class="nx">render</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">domElement</span><span class="p">))</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="c1">// æ™®é€šå±æ€§çš„å¤„ç†</span>
            <span class="nx">domElement</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">propName</span><span class="p">,</span> <span class="nx">props</span><span class="p">[</span><span class="nx">propName</span><span class="p">])</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">parentNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">domElement</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="p">{</span><span class="nx">render</span><span class="p">}</span>
</code></pre></div></div>

<h2 id="ä¸ƒçŠ¶æ€å’Œå±æ€§">ä¸ƒã€çŠ¶æ€å’Œå±æ€§</h2>
<h3 id="1å«ä¹‰">1ã€å«ä¹‰</h3>
<ul>
  <li>ç»„ä»¶çš„æ•°æ®æ¥æºæœ‰ä¸¤ä¸ªåœ°æ–¹ï¼Œåˆ†åˆ«æ˜¯å±æ€§å¯¹è±¡å’ŒçŠ¶æ€å¯¹è±¡</li>
  <li>å±æ€§æ˜¯çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„ï¼ˆé»˜è®¤å±æ€§ã€å±æ€§æ ¡éªŒï¼‰</li>
  <li>çŠ¶æ€æ˜¯è‡ªå·±å†…éƒ¨çš„ï¼Œæ”¹å˜çŠ¶æ€å”¯ä¸€çš„æ–¹å¼å°±æ˜¯ setState</li>
  <li>å±æ€§å’ŒçŠ¶æ€çš„å˜åŒ–éƒ½ä¼šå½±å“è§†å›¾æ›´æ–°</li>
</ul>

<h3 id="2ä¸è¦ç›´æ¥ä¿®æ”¹-state">2ã€ä¸è¦ç›´æ¥ä¿®æ”¹ state</h3>
<ul>
  <li>æ„é€ å‡½æ•°æ˜¯å”¯ä¸€å¯ä»¥ç»™ this.state èµ‹å€¼çš„åœ°æ–¹</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">number</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timerID</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span>
            <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">number</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
                <span class="c1">// ä¸‹é¢ä¸å¯å–</span>
                <span class="c1">// this.state.number = this.state.number + 1;</span>
            <span class="p">},</span>
            <span class="mi">1000</span>
        <span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timerID</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span> <span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="3state-çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„">3ã€state çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„</h3>
<ul>
  <li>å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œ React å¯èƒ½ä¼šæŠŠå¤šä¸ª setState() è°ƒç”¨åˆå¹¶æˆä¸€ä¸ªè°ƒç”¨</li>
  <li>å› ä¸º this.props å’Œ this.state å¯èƒ½ä¼šå¼‚æ­¥æ›´æ–°ï¼Œæ‰€ä»¥ä¸è¦ä¾èµ–ä»–ä»¬çš„å€¼æ¥æ›´æ–°ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œå¦‚æœå¸Œæœ›è¿™æ ·åšï¼Œé‚£ä¹ˆåº”å‚è€ƒä¸‹é¢çš„åšæ³•</li>
  <li>å¯ä»¥è®© setState() æ¥æ”¶ä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå‡½æ•°ç”¨ä¸Šä¸€ä¸ª state çš„å€¼ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">number</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="c1">//this.setState({number:this.state.number+1});</span>
        <span class="c1">//console.log(this.state.number);</span>
        <span class="c1">//this.setState({number:this.state.number+1});</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span>
            <span class="p">{</span><span class="na">number</span><span class="p">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
        <span class="p">));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span>
            <span class="p">{</span><span class="na">number</span><span class="p">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
        <span class="p">));</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span> <span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span>
    <span class="nx">Counter</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h3 id="4state-çš„æ›´æ–°ä¼šè¢«åˆå¹¶">4ã€state çš„æ›´æ–°ä¼šè¢«åˆå¹¶</h3>
<ul>
  <li>å½“è°ƒç”¨ setState() çš„æ—¶å€™ï¼Œ React ä¼šæŠŠæˆ‘ä»¬æä¾›çš„å¯¹è±¡åˆå¹¶åˆ°å½“å‰çš„ state</li>
</ul>

<h3 id="5æ•°æ®æ˜¯å•å‘æµåŠ¨çš„è€Œä¸”æ˜¯å‘ä¸‹æµåŠ¨çš„">5ã€æ•°æ®æ˜¯å•å‘æµåŠ¨çš„ï¼Œè€Œä¸”æ˜¯å‘ä¸‹æµåŠ¨çš„</h3>
<ul>
  <li>ä¸ç®¡æ˜¯çˆ¶ç»„ä»¶è¿˜æ˜¯å­ç»„ä»¶éƒ½æ— æ³•çŸ¥é“æŸä¸ªç»„ä»¶æ˜¯æœ‰çŠ¶æ€çš„è¿˜æ˜¯æ— çŠ¶æ€çš„ï¼Œå¹¶ä¸”å®ƒä»¬ä¸å…³å¿ƒå®ƒæ˜¯å‡½æ•°ç»„ä»¶è¿˜æ˜¯ç±»ç»„ä»¶</li>
  <li>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç§° state ä¸ºå±€éƒ¨çš„æˆ–è€…æ˜¯å°è£…çš„åŸå› ï¼Œé™¤äº†æ‹¥æœ‰å®ƒå¹¶è®¾ç½®å®ƒçš„ç»„ä»¶ä¹‹å¤–ï¼Œå…¶ä»–ç»„ä»¶éƒ½æ— æ³•è®¿é—®</li>
  <li>ä»»ä½• state æ€»æ˜¯å±äºç‰¹å®šçš„ç»„ä»¶ï¼Œè€Œä¸”ä»è¯¥ state æ´¾ç”Ÿçš„ä»»ä½•æ•°æ®æˆ– UI åªèƒ½å½±å“æ ‘ä¸­â€œä½äºâ€å®ƒä»¬çš„ç»„ä»¶ï¼Œå³å®ƒä»¬çš„å­ç»„ä»¶</li>
  <li>å¦‚æœæŠŠä¸€ä¸ªä»¥ç»„ä»¶æ„æˆçš„æ ‘æƒ³è±¡æˆä¸€ä¸ª props çš„æ•°æ®ç€‘å¸ƒæµï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªç»„ä»¶çš„ state å°±åƒæ˜¯åœ¨ä»»æ„ä¸€ç‚¹ä¸Šç»™ç€‘å¸ƒå¢åŠ é¢å¤–çš„æ°´æºï¼Œä½†æ˜¯å®ƒåªèƒ½å‘ä¸‹æµåŠ¨</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">name</span><span class="p">:</span><span class="dl">'</span><span class="s1">Jeamn</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">number</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">};</span>
    <span class="p">}</span>
    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">((</span><span class="nx">state</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span>
            <span class="p">{</span><span class="na">number</span><span class="p">:</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span>
        <span class="p">));</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span>
                <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">name</span><span class="p">}:</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span> <span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">SubCounter</span> <span class="nx">number</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">SubCounter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">(){</span>
      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=&gt;</span><span class="err">å­è®¡æ•°å™¨</span><span class="p">:{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">;
</span>  <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Counter</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h2 id="å…«äº‹ä»¶å¤„ç†">å…«ã€äº‹ä»¶å¤„ç†</h2>
<h3 id="1å†…å®¹">1ã€å†…å®¹</h3>
<ul>
  <li>Reactäº‹ä»¶çš„å‘½åé‡‡ç”¨å°é©¼å³°å¼</li>
  <li>ä½¿ç”¨ JSX è¯­æ³•æ—¶éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</li>
  <li>ä¸èƒ½é€šè¿‡è¿”å› false çš„æ–¹å¼é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¿…é¡»æ˜¾ç¤ºçš„ä½¿ç”¨ preventDefault()</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Link</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleClick</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">The link was clicked.</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://www.baidu.com</span><span class="dl">"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="nx">Click</span> <span class="nx">me</span>
          <span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Link</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h2 id="2this">2ã€this</h2>
<p>å¯ä»¥é€šè¿‡å‡ ä¸ªæ–¹æ³•æ”¹å˜ JSX å›è°ƒå‡½æ•°ä¸­çš„ thisï¼Œ</p>
<ul>
  <li>ç±»çš„å…¬å…±å±æ€§ï¼ˆç®­å¤´å‡½æ•°ï¼‰</li>
  <li>åŒ¿åç®­å¤´å‡½æ•°ï¼Œthis æŒ‡å‘ render å‡½æ•°çš„ thisï¼Œå³æŒ‡å‘å½“å‰ç»„ä»¶å®ä¾‹</li>
  <li>bind è¿›è¡Œç»‘å®š</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">LoggingButton</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleClick</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">this is:</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">handleClick1</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">this is:</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// onClick={this.handleClick.bind(this)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">(</span><span class="nx">event</span><span class="p">)}</span><span class="o">&gt;</span>
                <span class="nx">Click</span> <span class="nx">me</span>
        <span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="3å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°">3ã€å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°</h3>
<ul>
  <li>åŒ¿åå‡½æ•°</li>
  <li>bind
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">LoggingButton</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">handleClick1</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">,</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">id:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">id</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
         <span class="o">&lt;&gt;</span>
          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">(</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">,</span><span class="nx">event</span><span class="p">)}</span><span class="o">&gt;</span>
              <span class="nx">Click</span> <span class="nx">me</span>
          <span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)}</span><span class="o">&gt;</span>
              <span class="nx">Click</span> <span class="nx">me</span>
          <span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>         <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="4ref">4ã€ref</h3>
<ul>
  <li>ref æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬è®¿é—® DOM èŠ‚ç‚¹æˆ–åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ </li>
  <li>åœ¨ React æ¸²æŸ“ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œè¡¨å•å…ƒç´ ä¸Šçš„ value å°†ä¼šè¦†ç›– DOM èŠ‚ç‚¹ä¸­çš„å€¼ï¼Œåœ¨éå—æ§ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ› React èƒ½èµ‹äºˆç»„ä»¶ä¸€ä¸ªåˆå§‹å€¼ï¼Œä½†æ˜¯ä¸å»æ§åˆ¶åç»­çš„æ›´æ–°ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ª defaultValue å±æ€§è€Œä¸æ˜¯ value</li>
</ul>

<h4 id="0è¡¨å•å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶">ï¼ˆ0ï¼‰è¡¨å•å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</h4>
<ul>
  <li>è¡¨å•åˆ†ä¸ºå—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</li>
  <li>ä½¿ React çš„ state æˆä¸ºå”¯ä¸€æ•°æ®æºï¼Œæ¸²æŸ“è¡¨å•çš„ React ç»„ä»¶è¿˜æ§åˆ¶ç€ç”¨æˆ·è¾“å…¥è¿‡ç¨‹ä¸­è¡¨å•å‘ç”Ÿçš„æ“ä½œã€‚è¢« React ä»¥è¿™ç§æ–¹å¼æ§åˆ¶å–å€¼çš„è¡¨å•è¾“å…¥å…ƒç´ å°±å«åšâ€œå—æ§ç»„ä»¶â€ã€‚</li>
  <li>è¡¨å•å…ƒç´ ï¼ˆå¦‚ inputã€textarea å’Œ selectï¼‰ä¹‹ç±»çš„è¡¨å•å…ƒç´ é€šå¸¸è‡ªå·±ç»´æŠ¤ state ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œæ›´æ–°ï¼Œè¿™æ˜¯éå—æ§ç»„ä»¶ã€‚</li>
</ul>

<h4 id="1ref-çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²-è¯¥è¯­æ³•å³å°†åºŸå¼ƒ">ï¼ˆ1ï¼‰ref çš„å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² ï¼ˆè¯¥è¯­æ³•å³å°†åºŸå¼ƒï¼‰</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Sum</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleAdd</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span>
        <span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">refs</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="dl">"</span><span class="s2">a</span><span class="dl">"</span> <span class="o">/&gt;</span> <span class="o">+</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="dl">"</span><span class="s2">b</span><span class="dl">"</span> <span class="o">/&gt;&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span><span class="o">&gt;=&lt;</span><span class="sr">/button&gt;&lt;input ref="c" /</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="2ref-çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•°-è¯¥è¯­æ³•å³å°†åºŸå¼ƒ">ï¼ˆ2ï¼‰ref çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•° ï¼ˆè¯¥è¯­æ³•å³å°†åºŸå¼ƒï¼‰</h4>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Sum</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nx">handleAdd</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">value</span>
        <span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">value</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">ref</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">ref</span><span class="p">}</span> <span class="sr">/&gt; + &lt;input ref={ref =&gt; this.b = ref} /</span><span class="o">&gt;&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span><span class="o">&gt;=&lt;</span><span class="sr">/button&gt;&lt;input ref={ref =&gt; this.c = ref} /</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="3ä¸º-dom-å…ƒç´ æ·»åŠ -ref">ï¼ˆ3ï¼‰ä¸º DOM å…ƒç´ æ·»åŠ  ref</h4>
<ul>
  <li>å¯ä»¥ä½¿ç”¨ ref å»å­˜å‚¨ DOM èŠ‚ç‚¹çš„å¼•ç”¨</li>
  <li>å½“ ref å±æ€§ç”¨äº HTML å…ƒç´ æ—¶ï¼Œæ„é€ å‡½æ•°ä¸­ä½¿ç”¨ React.createRef() åˆ›å»ºçš„ ref æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºå…¶ current å±æ€§
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Sum</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
      <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">()</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">()</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">c</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">()</span>
  <span class="p">}</span>
  <span class="nx">handleAdd</span> <span class="o">=</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span>
      <span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">c</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">(){</span>
      <span class="k">return</span> <span class="p">(</span>
          <span class="o">&lt;&gt;</span>
              <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">a</span><span class="p">}</span> <span class="sr">/&gt; + &lt;input ref={this.b} /</span><span class="o">&gt;&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span><span class="o">&gt;=&lt;</span><span class="sr">/button&gt;&lt;input ref={this.c} /</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="4ä¸º-class-ç»„ä»¶æ·»åŠ -ref">ï¼ˆ4ï¼‰ä¸º class ç»„ä»¶æ·»åŠ  ref</h4>
<ul>
  <li>å½“ ref å±æ€§ç”¨äºè‡ªå®šä¹‰ class ç»„ä»¶æ—¶ï¼Œref å¯¹è±¡æ¥æ”¶ç»„ä»¶çš„æŒ‚è½½å®ä¾‹ä½œä¸ºå…¶ current å±æ€§
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
      <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">getFocus</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
          <span class="o">&lt;&gt;</span>
            <span class="o">&lt;</span><span class="nx">TextInput</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">}</span><span class="o">&gt;</span><span class="err">è·å¾—ç„¦ç‚¹</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">TextInput</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
      <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">getFocus</span> <span class="o">=</span><span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">(){</span>
      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="5ref-è½¬å‘">ï¼ˆ5ï¼‰ref è½¬å‘</h4>
<ul>
  <li>ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨ ref å±æ€§ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å®ä¾‹</li>
  <li>ref è½¬å‘æ˜¯ä¸€é¡¹å°† ref è‡ªåŠ¨åœ°é€šè¿‡ç»„ä»¶ä¼ é€’åˆ°å…¶ä¸€å­ç»„ä»¶çš„æŠ€å·§</li>
  <li>ref è½¬å‘å…è®¸æŸäº›ç»„ä»¶æ¥æ”¶ ref ï¼Œå¹¶å°†å…¶å‘ä¸‹ä¼ é€’ï¼ˆè½¬å‘å®ƒï¼‰ç»™å­ç»„ä»¶
    <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
<span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">getFocus</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">();</span>
<span class="p">}</span>
<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;&gt;</span>
          <span class="o">&lt;</span><span class="nx">TextInput</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">}</span><span class="o">&gt;</span><span class="err">è·å¾—ç„¦ç‚¹</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>    <span class="p">);</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="c1">//Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?</span>
<span class="kd">function</span> <span class="nx">TextInput</span> <span class="p">(){</span>
<span class="k">return</span> <span class="o">&lt;</span><span class="nx">input</span><span class="o">/&gt;</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>å‡½æ•°ç»„ä»¶å¿…é¡»ä½¿ç”¨ forwardRef</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">getFocus</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;&gt;</span>
              <span class="o">&lt;</span><span class="nx">TextInput</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">}</span><span class="o">&gt;</span><span class="err">è·å¾—ç„¦ç‚¹</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">TextInput</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">forwardRef</span><span class="p">((</span><span class="nx">props</span><span class="p">,</span><span class="nx">ref</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">ref</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span><span class="p">));</span>
</code></pre></div></div>

<p>å®ç°åŸç†</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">createRef</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">getFocus</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;&gt;</span>
              <span class="o">&lt;</span><span class="nx">TextInput</span> <span class="nx">myref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>              <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">getFocus</span><span class="p">}</span><span class="o">&gt;</span><span class="err">è·å¾—ç„¦ç‚¹</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">forwardRef</span><span class="p">(</span><span class="nx">funcComponent</span><span class="p">){</span>
    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
        <span class="kd">let</span> <span class="nx">ref</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">myref</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">funcComponent</span><span class="p">(</span><span class="nx">props</span><span class="p">,</span><span class="nx">ref</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">const</span> <span class="nx">TextInput</span> <span class="o">=</span> <span class="nx">forwardRef</span><span class="p">((</span><span class="nx">props</span><span class="p">,</span><span class="nx">ref</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">ref</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span><span class="p">));</span>
</code></pre></div></div>

<h2 id="ä¹çŠ¶æ€æå‡">ä¹ã€çŠ¶æ€æå‡</h2>
<ul>
  <li>åœ¨ React ä¸­ï¼Œå°†å¤šä¸ªç»„ä»¶ä¸­éœ€è¦å…±äº«çš„ state å‘ä¸Šç§»åŠ¨åˆ°å®ƒä»¬çš„æœ€è¿‘å…±åŒçˆ¶ç»„ä»¶ä¸­ï¼Œä¾¿å¯å®ç°å…±äº« stateã€‚è¿™å°±æ˜¯æ‰€è°“çš„â€œçŠ¶æ€æå‡â€</li>
  <li>æ²¡æœ‰çŠ¶æ€æå‡</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">declareTypeAlias</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">@babel/types</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Todos</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
   <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
       <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
           <span class="na">text</span><span class="p">:</span><span class="dl">''</span><span class="p">,</span>
           <span class="na">todos</span><span class="p">:[]</span>
       <span class="p">}</span>
   <span class="p">}</span>
   <span class="nx">handleAdd</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">todos</span><span class="p">:[...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">,{</span><span class="na">id</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span><span class="na">text</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">text</span><span class="p">}],</span>
        <span class="na">text</span><span class="p">:</span><span class="dl">''</span>
    <span class="p">});</span>
   <span class="p">}</span>
   <span class="nx">handleDelete</span><span class="p">(</span><span class="nx">id</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">todos</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">todo</span><span class="o">=&gt;</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span> <span class="o">!=</span> <span class="nx">id</span><span class="p">)</span>
    <span class="p">});</span>
   <span class="p">}</span>
   <span class="nx">handleChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">text</span><span class="p">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">});</span>
   <span class="p">}</span>

   <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
       <span class="kd">let</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">todo</span><span class="o">=&gt;&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span><span class="o">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">handleDelete</span><span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">X</span><span class="o">&lt;</span><span class="sr">/button&gt;&lt;/</span><span class="nx">li</span><span class="o">&gt;</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span>
           <span class="o">&lt;&gt;</span>
            <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="o">&amp;&amp;&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span><span class="err">}
</span>            <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text</span><span class="dl">"</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">submit</span><span class="dl">"</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">todos</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>            <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">?</span><span class="s2">`ä½ ç°åœ¨</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">ä»¶å¾…åŠäº‹é¡¹`</span><span class="p">:</span><span class="s2">`ä½ ç°åœ¨æ²¡æœ‰å¾…åŠäº‹é¡¹`</span><span class="p">}</span>
           <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Todos</span> <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">å¾…åŠäº‹é¡¹</span><span class="dl">"</span><span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>çŠ¶æ€æå‡</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Todos</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
   <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
       <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
       <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
           <span class="na">text</span><span class="p">:</span><span class="dl">''</span><span class="p">,</span>
           <span class="na">todos</span><span class="p">:[]</span>
       <span class="p">}</span>
   <span class="p">}</span>
   <span class="nx">handleAdd</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">todos</span><span class="p">:[...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">,{</span><span class="na">id</span><span class="p">:</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">(),</span><span class="na">text</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">text</span><span class="p">}],</span>
        <span class="na">text</span><span class="p">:</span><span class="dl">''</span>
    <span class="p">});</span>
   <span class="p">}</span>
   <span class="nx">handleDelete</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">todos</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">todo</span><span class="o">=&gt;</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span> <span class="o">!=</span> <span class="nx">id</span><span class="p">)</span>
    <span class="p">});</span>
   <span class="p">}</span>
   <span class="nx">handleChange</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
        <span class="na">text</span><span class="p">:</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span>
    <span class="p">});</span>
   <span class="p">}</span>

   <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">(</span>
           <span class="o">&lt;&gt;</span>
            <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="o">&amp;&amp;&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span><span class="err">}
</span>            <span class="o">&lt;</span><span class="nx">TodoHeader</span> <span class="nx">text</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span>  <span class="nx">handleAdd</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span> <span class="nx">handleChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span><span class="sr">/&gt;   </span><span class="err"> 
</span>            <span class="o">&lt;</span><span class="nx">TodoItems</span> <span class="nx">todos</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">}</span> <span class="nx">handleDelete</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleDelete</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="nx">TodoFooter</span> <span class="nx">todos</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">todos</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>           <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">TodoHeader</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">form</span> <span class="nx">onSubmit</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">handleAdd</span><span class="p">}</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">text</span><span class="dl">"</span> <span class="nx">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span> <span class="nx">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>                <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="dl">"</span><span class="s2">submit</span><span class="dl">"</span><span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="sr">/form</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">TodoItems</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="kd">let</span> <span class="nx">todos</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">todo</span><span class="o">=&gt;&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">todo</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span><span class="o">=&gt;</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">handleDelete</span><span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">X</span><span class="o">&lt;</span><span class="sr">/button&gt;&lt;/</span><span class="nx">li</span><span class="o">&gt;</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
              <span class="p">{</span> <span class="nx">todos</span><span class="p">}</span>
            <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">TodoFooter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="k">return</span> <span class="p">(</span>
           <span class="o">&lt;&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">?</span><span class="s2">`ä½ ç°åœ¨</span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">ä»¶å¾…åŠäº‹é¡¹`</span><span class="p">:</span><span class="s2">`ä½ ç°åœ¨æ²¡æœ‰å¾…åŠäº‹é¡¹`</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Todos</span> <span class="nx">name</span><span class="o">=</span><span class="dl">"</span><span class="s2">å¾…åŠäº‹é¡¹</span><span class="dl">"</span><span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<h2 id="åç”Ÿå‘½å‘¨æœŸ">åã€ç”Ÿå‘½å‘¨æœŸ</h2>
<h3 id="1æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ">1ã€æ—§ç‰ˆç”Ÿå‘½å‘¨æœŸ</h3>
<h4 id="ç¬¬ä¸€é˜¶æ®µinitializationæ¥æ”¶çš„å±æ€§å’Œè‡ªèº«çš„çŠ¶æ€åˆå§‹åŒ–">ç¬¬ä¸€é˜¶æ®µï¼ˆInitializationï¼‰ï¼šæ¥æ”¶çš„å±æ€§å’Œè‡ªèº«çš„çŠ¶æ€åˆå§‹åŒ–</h4>
<ul>
  <li>setup props and state</li>
</ul>

<h4 id="ç¬¬äºŒé˜¶æ®µmountingç»„ä»¶å®ä¾‹æŒ‚è½½ä¸æ¸²æŸ“">ç¬¬äºŒé˜¶æ®µï¼ˆMountingï¼‰ï¼šç»„ä»¶å®ä¾‹æŒ‚è½½ä¸æ¸²æŸ“</h4>
<ul>
  <li>componentWillMountï¼šç»„ä»¶å°†è¦æŒ‚è½½</li>
  <li>renderï¼šç»„ä»¶æ¸²æŸ“</li>
  <li>componentDidMountï¼šç»„ä»¶æŒ‚è½½å®Œæˆ</li>
</ul>

<h4 id="ç¬¬ä¸‰é˜¶æ®µupdationæ•°æ®æ›´æ–°">ç¬¬ä¸‰é˜¶æ®µï¼ˆUpdationï¼‰ï¼šæ•°æ®æ›´æ–°</h4>
<p>1ï¼‰props æ¥æ”¶çš„å±æ€§æ•°æ®æ›´æ–°</p>
<ul>
  <li>componentWillReceivePropsï¼šç»„ä»¶å°†è¦æ¥æ”¶ props</li>
  <li>shouldComponentUpdateï¼šç»„ä»¶åº”è¯¥æ›´æ–°å—ï¼ˆè¿”å› true æ‰èƒ½æ›´æ–°ï¼‰</li>
  <li>componentWillUpdateï¼šç»„ä»¶å°†è¦æ›´æ–°æ•°æ®</li>
  <li>renderï¼šç»„ä»¶æ¸²æŸ“</li>
  <li>componentDidUpdateï¼šç»„ä»¶æ•°æ®æ›´æ–°å®Œæˆ</li>
</ul>

<p>2ï¼‰state è‡ªèº«çš„çŠ¶æ€æ•°æ®æ›´æ–°</p>
<ul>
  <li>shouldComponentUpdateï¼šç»„ä»¶åº”è¯¥æ›´æ–°å—ï¼ˆè¿”å› true æ‰èƒ½æ›´æ–°ï¼‰</li>
  <li>componentWillUpdateï¼šç»„ä»¶å°†è¦æ›´æ–°æ•°æ®</li>
  <li>renderï¼šç»„ä»¶æ¸²æŸ“</li>
  <li>componentDidUpdateï¼šç»„ä»¶æ•°æ®æ›´æ–°å®Œæˆ
    <h4 id="ç¬¬å››é˜¶æ®µunmountingç»„ä»¶å¸è½½">ç¬¬å››é˜¶æ®µï¼ˆUnmountingï¼‰ï¼šç»„ä»¶å¸è½½</h4>
  </li>
  <li>componentWillUnmountï¼šç»„ä»¶å°†è¦å¸è½½</li>
</ul>

<p>ä¾‹å­ï¼š</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span><span class="nx">Component</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span>
<span class="k">import</span> <span class="nx">ReactDom</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span>

<span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">1ã€constructor</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">super</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">number</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">componentWillMount</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">2ã€componentWillMountï¼šç»„ä»¶å°†è¦æŒ‚è½½</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentDidMount</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">4ã€componentDidMountï¼šç»„ä»¶å®ŒæˆæŒ‚è½½</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">shouldComponentUpdate</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span><span class="nx">nextState</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">5ã€ç»„ä»¶æ˜¯å¦å¯ä»¥æ›´æ–°</span><span class="dl">'</span><span class="p">,</span> <span class="nx">nextProps</span><span class="p">,</span><span class="nx">nextState</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">nextState</span><span class="p">.</span><span class="nx">number</span><span class="o">%</span><span class="mi">2</span>
    <span class="p">}</span>
    <span class="nx">componentWillUpdate</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">6ã€ç»„ä»¶å°†è¦æ›´æ–°</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentDidUpdate</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">7ã€ç»„ä»¶å®Œæˆæ›´æ–°</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">add</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span><span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="na">number</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="p">})</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3ã€render ç»„ä»¶æ¸²æŸ“</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">%</span><span class="mi">3</span> <span class="o">===</span> <span class="mi">0</span> <span class="p">?</span> <span class="kc">null</span> <span class="p">:</span> <span class="o">&lt;</span><span class="nx">ChildCount</span> <span class="nx">num</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="sr">/&gt;</span><span class="err">}
</span>                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>            <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="nx">ChildCount</span> <span class="kd">extends</span> <span class="nx">Component</span><span class="p">{</span>
    <span class="nx">componentWillReceiveProps</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child componentWillReceiveProps</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentWillMount</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶å°†è¦æŒ‚è½½</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentDidMount</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶å®ŒæˆæŒ‚è½½</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">shouldComponentUpdate</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span><span class="nx">nextState</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶æ˜¯å¦å¯ä»¥æ›´æ–°</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">nextProps</span><span class="p">.</span><span class="nx">num</span><span class="o">%</span><span class="mi">3</span> <span class="o">===</span> <span class="mi">0</span>
    <span class="p">}</span>
    <span class="nx">componentWillUpdate</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶å°†è¦æ›´æ–°</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentDidUpdate</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶å®Œæˆæ›´æ–°</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">componentWillUnmount</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child ç»„ä»¶å°†è¦å¸è½½</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">(){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child render</span><span class="dl">'</span><span class="p">);</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">num</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">ReactDom</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">Counter</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="2æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ">2ã€æ–°ç‰ˆç”Ÿå‘½å‘¨æœŸ</h3>
<h4 id="ç¬¬ä¸€é˜¶æ®µåˆ›å»ºæ—¶">ç¬¬ä¸€é˜¶æ®µï¼ˆåˆ›å»ºæ—¶ï¼‰ï¼š</h4>
<ul>
  <li>constructorï¼šæ„é€ å‡½æ•°åˆå§‹åŒ–æ•°æ®</li>
  <li>getDerivedStateFromPropsï¼šå°†ä¼ å…¥çš„propsæ˜ å°„åˆ° state ä¸Šé¢</li>
  <li>componentDidUpdateï¼šReact æ›´æ–° DOM å’Œ refs</li>
  <li>componentDidMountï¼šç»„ä»¶æŒ‚è½½å®Œæˆ</li>
</ul>

<h4 id="ç¬¬äºŒé˜¶æ®µæ›´æ–°æ—¶">ç¬¬äºŒé˜¶æ®µï¼ˆæ›´æ–°æ—¶ï¼‰ï¼š</h4>
<ul>
  <li>getDerivedStateFromPropsï¼šå°†ä¼ å…¥çš„propsæ˜ å°„åˆ° state ä¸Šé¢</li>
  <li>shouldComponentUpdateï¼šç»„ä»¶åº”è¯¥æ›´æ–°å—ï¼ˆè¿”å› true æ‰èƒ½æ›´æ–°ï¼‰</li>
  <li>renderï¼šç»„ä»¶æ¸²æŸ“</li>
  <li>getSnapshotBeforeUpdateï¼šè¢«è°ƒç”¨äºrenderä¹‹åï¼Œå¯ä»¥è¯»å–ä½†æ— æ³•ä½¿ç”¨DOMçš„æ—¶å€™</li>
  <li>componentDidUpdateï¼šReact æ›´æ–° DOM å’Œ refs</li>
  <li>componentDidUpdateï¼šç»„ä»¶æ•°æ®æ›´æ–°å®Œæˆ</li>
</ul>

<h4 id="ç¬¬ä¸‰é˜¶æ®µå¸è½½æ—¶æ¥æ”¶çš„å±æ€§å’Œè‡ªèº«çš„çŠ¶æ€åˆå§‹åŒ–">ç¬¬ä¸‰é˜¶æ®µï¼ˆå¸è½½æ—¶ï¼‰ï¼šæ¥æ”¶çš„å±æ€§å’Œè‡ªèº«çš„çŠ¶æ€åˆå§‹åŒ–</h4>
<ul>
  <li>componentWillUnmountï¼šç»„ä»¶å°†è¦å¸è½½</li>
</ul>

<p>ä¾‹å­ï¼š
ï¼ˆ1ï¼‰getDerivedStateFromPropsï¼š</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">Counter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span> 
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">){</span>
      <span class="k">super</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">number</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">handleClick</span><span class="o">=</span><span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="na">number</span><span class="p">:</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="o">+</span><span class="mi">1</span><span class="p">});</span>
    <span class="p">};</span>

    <span class="nx">render</span><span class="p">(){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3.render</span><span class="dl">'</span><span class="p">);</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">ChildCounter</span> <span class="nx">number</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="p">)</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">class</span> <span class="nx">ChildCounter</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span><span class="p">{</span>
      <span class="kd">constructor</span><span class="p">(){</span>
          <span class="k">super</span><span class="p">();</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">number</span><span class="p">:</span><span class="mi">0</span><span class="p">};</span>
      <span class="p">}</span>
    <span class="kd">static</span> <span class="nx">getDerivedStateFromProps</span><span class="p">(</span><span class="nx">nextProps</span><span class="p">,</span> <span class="nx">prevState</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="p">{</span><span class="nx">number</span><span class="p">}</span> <span class="o">=</span> <span class="nx">nextProps</span><span class="p">;</span>
        <span class="c1">// å½“ä¼ å…¥çš„typeå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ›´æ–°state</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">number</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="p">{</span> <span class="na">number</span><span class="p">:</span><span class="nx">number</span><span class="o">*</span><span class="mi">2</span><span class="p">};</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="k">return</span> <span class="p">{</span> <span class="na">number</span><span class="p">:</span><span class="nx">number</span><span class="o">*</span><span class="mi">3</span><span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">(){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">child-render</span><span class="dl">'</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">number</span><span class="p">}</span>
      <span class="o">&lt;</span><span class="sr">/div&gt;</span><span class="err">)
</span>    <span class="p">}</span>

  <span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Counter</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>
<p>ï¼ˆ2ï¼‰getSnapshotBeforeUpdateï¼šå®ƒä½¿ç»„ä»¶å¯ä»¥åœ¨å¯èƒ½æ›´æ”¹ä¹‹å‰ä» DOM æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚æ»šåŠ¨ä½ç½®ï¼‰ã€‚æ­¤ç”Ÿå‘½å‘¨æœŸè¿”å›çš„ä»»ä½•å€¼éƒ½å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ componentDidUpdate()</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">react-dom</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">ScrollingList</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="na">messages</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createRef</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nx">addMessage</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">state</span> <span class="o">=&gt;</span> <span class="p">({</span>
            <span class="na">messages</span><span class="p">:</span> <span class="p">[</span><span class="s2">`</span><span class="p">${</span><span class="nx">state</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">length</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span> <span class="p">...</span><span class="nx">state</span><span class="p">.</span><span class="nx">messages</span><span class="p">],</span>
        <span class="p">}))</span>
    <span class="p">}</span>
    <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">timeID</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">addMessage</span><span class="p">();</span>
        <span class="p">},</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="nx">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">timeID</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">getSnapshotBeforeUpdate</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//å…³é”®ç‚¹ï¼šè·å–å½“å‰rootNodeçš„scrollHeightï¼Œä¼ åˆ°componentDidUpdate çš„å‚æ•°perScrollHeight</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">scrollHeight</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">componentDidUpdate</span><span class="p">(</span><span class="nx">perProps</span><span class="p">,</span> <span class="nx">perState</span><span class="p">,</span> <span class="nx">prevScrollHeight</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//å½“å‰å‘ä¸Šå·å»çš„é«˜åº¦</span>
        <span class="kd">const</span> <span class="nx">curScrollTop</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
        <span class="c1">//å½“å‰å‘ä¸Šå·å»çš„é«˜åº¦åŠ ä¸Šå¢åŠ çš„å†…å®¹é«˜åº¦</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">=</span> <span class="nx">curScrollTop</span> <span class="o">+</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">.</span><span class="nx">current</span><span class="p">.</span><span class="nx">scrollHeight</span> <span class="o">-</span> <span class="nx">prevScrollHeight</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">let</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">height</span><span class="p">:</span> <span class="dl">'</span><span class="s1">100px</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">width</span><span class="p">:</span> <span class="dl">'</span><span class="s1">200px</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">border</span><span class="p">:</span> <span class="dl">'</span><span class="s1">1px solid red</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">overflow</span><span class="p">:</span> <span class="dl">'</span><span class="s1">auto</span><span class="dl">'</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">style</span><span class="p">}</span> <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">wrapper</span><span class="p">}</span> <span class="o">&gt;</span>
                <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">messages</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">message</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">index</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">message</span><span class="p">}</span> <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>                <span class="p">))}</span>
            <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ScrollingList</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">root</span><span class="dl">'</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<p><strong><em>å€Ÿé‰´çš„æ–‡æ¡£ï¼š</em></strong></p>

<p><a href="https://zh-hans.reactjs.org/docs">React å®˜æ–¹æ•™ç¨‹</a></p>
:ET